---
title: "Transport Planning Methods - Assignment 2"
author: "2722008W"
date: "2022-03-28"
output: pdf_document
bibliography: bib.yaml
---

# Introduction & Literature Review

It is well understood that younger people, especially under 30s, are more likely to travel by public transit than older people. It is less clear to what extent this tendency is a result of life cycle factors which change as generational cohorts age in contrast to a sign that younger cohorts exhibit an enduring preference for public transit. This is highly pertinent to anyone seeking to reduce car dependency in the interest of fostering safer, space-efficient and sustainable urban environments. This research paper makes use of data from the National Travel Survey of residents of England from years 2009 and 2019 to analyse the changing levels of public transit use of three cohorts across those ten years.

# Methodology
The stage, trip, household and individual tables were used. Only stages of 0.5 miles or greater length were included. Any missing values were dropped. In total 196,756 trip stages were analysed from 8,424 individuals surveyed in 2009 and 6,182 in 2019.

The mode of each stage was categorised as either "Public transport or active travel" or "Private vehicle". The category of "Private vehicle" includes stages where the individual travelled by private car (as either driver or passenger), by taxi or where the mode was recorded as "Other private transport". "Public transport or active travel" includes all other modes such as walking, cycling, bus, train etc.

The age variable was recoded such as to represent generational cohorts. For example, in the 2009 data, ages 20-29 were coded as having been born in the 1980s and in the 2019 data ages 30-39 were coded as having been born in the 1980s.

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(tidyverse)
library(ggplot2)
```

```{r, echo=FALSE}
stage = read_tsv("data/UKDA-5340-tab/tab/stage_eul_2002-2020.tab") %>%
  select(IndividualID, TripID, StageDistance, StageTime, StageMode_B11ID, SurveyYear) %>%
  filter(SurveyYear == 2009 | SurveyYear == 2019) %>%
  filter(StageDistance >= 0.5) %>%
  mutate(StageMode_B11ID = factor(StageMode_B11ID, 1:13, labels = c("Public transport or active travel", "Public transport or active travel", "Private vehicle", "Private vehicle", "Private vehicle", "Private vehicle", "Public transport or active travel", "Public transport or active travel", "Public transport or active travel", "Public transport or active travel", "Public transport or active travel", "Private vehicle", "Public transport or active travel"))) %>%
  drop_na()

individual2009 = read_tsv("data/UKDA-5340-tab/tab/individual_eul_2002-2020.tab") %>%
  select(HouseholdID, IndividualID, Age_B01ID, Sex_B01ID, EthGroupTS_B02ID, SurveyYear) %>%
  filter(SurveyYear == 2009) %>%
  mutate(Sex_B01ID = factor(Sex_B01ID, 1:2, labels = c("Male", "Female")),
         EthGroupTS_B02ID = factor(EthGroupTS_B02ID, 1:2, labels = c("White", "Non-white")),
         BirthDecade = factor(Age_B01ID, 10:14, labels = c("1980-89", "1980-89", "1980-89", "1970-79", "1960-69"))) %>%
  drop_na()

individual2019 = read_tsv("data/UKDA-5340-tab/tab/individual_eul_2002-2020.tab") %>%
  select(HouseholdID, IndividualID, Age_B01ID, Sex_B01ID, EthGroupTS_B02ID, SurveyYear) %>%
  filter(SurveyYear == 2019) %>%
  mutate(Sex_B01ID = factor(Sex_B01ID, 1:2, labels = c("Male", "Female")),
         EthGroupTS_B02ID = factor(EthGroupTS_B02ID, 1:2, labels = c("White", "Non-white")),
         BirthDecade = factor(Age_B01ID, 13:15, labels = c("1980-89", "1970-79", "1960-69"))) %>%
  drop_na()

trip = read_tsv("data/UKDA-5340-tab/tab/trip_eul_2002-2020.tab") %>%
  select(TripID, IndividualID, TripPurpose_B04ID, SurveyYear) %>%
  mutate(TripPurpose_B04ID = factor(TripPurpose_B04ID, 1:8, labels = c("Commuting", "Business", "Education / escort education", "Shopping", "Other escort", "Personal business", "Leisure", "Other including just walk"))) %>%
  drop_na()

household = read_tsv("data/UKDA-5340-tab/tab/household_eul_2002-2020.tab") %>%
  filter(SurveyYear == 2019 | SurveyYear == 2009) %>%
  select(HouseholdID, HHIncQDSEngTS_B01ID, SurveyYear) %>%
  mutate(HHIncQDSEngTS_B01ID = factor(HHIncQDSEngTS_B01ID, 1:5)) %>%
  drop_na()

```

```{r}

allMerged = individual2009 %>%
  rbind(individual2019) %>%
  merge(household) %>%
  merge(stage) %>%
  merge(trip) %>%
  drop_na() %>%
  mutate(SurveyYear = factor(SurveyYear, c(2009, 2019))) %>%
  select(StageDistance, StageMode_B11ID, BirthDecade, Sex_B01ID, 
         EthGroupTS_B02ID, HHIncQDSEngTS_B01ID, TripPurpose_B04ID, SurveyYear)

summary(allMerged)
```

```{r}
ggplot(allMerged %>% filter(SurveyYear == 2009), aes(x = BirthDecade, fill = StageMode_B11ID)) +
  geom_bar(position = "fill")

ggplot(allMerged %>% filter(SurveyYear == 2019), aes(x = BirthDecade, fill = StageMode_B11ID)) +
  geom_bar(position = "fill")
```
It was found that private

```{r}
logit2009 = glm(StageMode_B11ID ~ BirthDecade + StageDistance + Sex_B01ID + EthGroupTS_B02ID + HHIncQDSEngTS_B01ID + TripPurpose_B04ID, family="binomial", data=allMerged %>% filter(SurveyYear == 2009), x=T)

logit2019 = glm(StageMode_B11ID ~ BirthDecade + StageDistance + Sex_B01ID + EthGroupTS_B02ID + HHIncQDSEngTS_B01ID + TripPurpose_B04ID, family="binomial", data=allMerged %>% filter(SurveyYear == 2019), x=T)

summary(logit2009)

```
